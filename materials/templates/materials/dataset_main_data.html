{% load materials_tags %}

<h5>{{ dataset.label }}</h5>
{% if dataset.primary_property.name == 'atomic coordinates' %}
  <!-- Atomic coordinates require special treatment -->
  {% with series=dataset.dataseries_set.all|first %}
    {% if series.datapoint_set.all %}
      <table class="table atomic-positions">
        {% for datapoint in series.datapoint_set.all %}
          {% cycle '<tr>' '' %}
          <td>{{ datapoint.datapointsymbol_set.all.0.symbol }}: </td>
          <td>{{ datapoint.numericalvalue_set.all.0.value|floatformat:4 }}
            {% cycle 'Ã…' '&deg;' %}</td>
          {% cycle '' '</tr>' %}
        {% endfor %}
      </table>
    {% endif %}
  {% endwith %}
  <p class="text-center">
    <a href="{% url "materials:download_input_files" pk=dataset.pk %}">
      <button type="button" class="btn btn-primary">
        <span class="fa fa-download" aria-hidden="true"></span>
        {{ dataset.primary_property.name }}
      </button>
    </a>
  </p>
{% elif dataset.plotted %}
  <!-- Plotted data -->
  <canvas id="figure_{{ dataset.pk }}" width="400" height="300"></canvas>
{% else %}
  <!-- Tabulated data -->
  {% with series=dataset.dataseries_set.all|first %}
    {% if series.datapoint_set.all %}
      <table class="table main-data">
        <thead>
          <tr>
            {% if dataset.primary_property %}
              <th>
                {{ dataset.primary_property }}, {{ dataset.primary_unit }}
              </th>
            {% endif %}
            {% if dataset.secondary_property %}
              <th>
                {{ dataset.secondary_property }}, {{ dataset.secondary_unit }}
              </th>
            {% endif %}
          </tr>
        </thead>
        {% for datapoint in series.datapoint_set.all %}
          <tr>
            {% for value in datapoint|datapoint %}
              {% if value %}<td>{{ value }}</td>{% endif %}
            {% endfor %}
          </tr>
        {% endfor %}
      </table>
    {% endif %}
  {% endwith %}
{% endif %}
