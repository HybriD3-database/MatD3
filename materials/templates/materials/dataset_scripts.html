<!-- Javascript functions that accompany dataset_contents.html. -->
{% load static %}

<script src="{% static 'materials/javascript/plot_data.js' %}"></script>
<script>
 {% for dataset in datasets %}
 if (document.getElementById('figure_{{ dataset.pk }}')) {
   {% with series=dataset.dataseries_set.all|first %}
   data = [
     {% for datapoint in series.datapoint_set.all %}
     {
       {% for value in datapoint.numericalvalue_set.all %}
       {% if value.qualifier == 1 %}
       x: {{ value.value }}
       {% else %}
       y: {{ value.value }}
       {% endif %}
       ,
       {% endfor %}
     },
     {% endfor %}
   ];
   plot_data('figure_{{ dataset.pk }}', data,
             '{{ dataset.secondary_property }}',
             '{{ dataset.secondary_unit }}',
             '{{ dataset.primary_property }}',
             '{{ dataset.primary_unit }}',
             '{{ series.label }}');
   {% endwith %}
 }
 {% endfor %}
</script>

<script>
 $('.delete_button').click(function() {
   if (confirm('Are you sure you want to remove this data set from the database?')) {
     window.open($(this).attr('data-reverse-url'), '_top');
   }
 });
</script>

<script>
 /* Change "click to expand" to "click to hide" and vice versa */
 $('.expand-hide-button').click(function() {
   if ($(this).html().includes('expand)')) {
     $(this).html($(this).html().split('expand)')[0] + 'hide)');
   } else {
     $(this).html($(this).html().split('hide)')[0] + 'expand)');
   }
 });
</script>
